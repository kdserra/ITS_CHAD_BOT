Todo:
    * Rely on hasPermission for commands